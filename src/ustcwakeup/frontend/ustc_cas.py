from PIL import Image
import io
import pickle
import aiohttp
import re


number_9 = b'\x80\x05\x95\xb1\x01\x00\x00\x00\x00\x00\x00\x8c\tPIL.Image\x94\x8c\x05Image\x94\x93\x94)\x81\x94]\x94(' \
           b'}\x94(\x8c\x04jfif\x94M\x02\x01\x8c\x0cjfif_version\x94K\x01K\x02\x86\x94\x8c\tjfif_unit\x94K\x00\x8c' \
           b'\x0cjfif_density\x94K\x01K\x01\x86\x94u\x8c\x01L\x94K\x0fK\x15\x86\x94NB;\x01\x00\x00\xff\xff\xff\xff' \
           b'\xff\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff' \
           b'\xff\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00' \
           b'\x00\x00\xff\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\xff\x00\x00\x00\xff\xff\xff\xff\xff' \
           b'\x00\x00\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff' \
           b'\x94eb.'

number_8 = b'\x80\x05\x95\xb1\x01\x00\x00\x00\x00\x00\x00\x8c\tPIL.Image\x94\x8c\x05Image\x94\x93\x94)\x81\x94]\x94(' \
           b'}\x94(\x8c\x04jfif\x94M\x02\x01\x8c\x0cjfif_version\x94K\x01K\x02\x86\x94\x8c\tjfif_unit\x94K\x00\x8c' \
           b'\x0cjfif_density\x94K\x01K\x01\x86\x94u\x8c\x01L\x94K\x0fK\x15\x86\x94NB;\x01\x00\x00\xff\xff\xff\xff' \
           b'\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff' \
           b'\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00\xff' \
           b'\xff\xff\xff\xff\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\xff\x00\x00' \
           b'\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00' \
           b'\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff' \
           b'\xff\xff\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x94eb.'

number_7 = b'\x80\x05\x95\xb1\x01\x00\x00\x00\x00\x00\x00\x8c\tPIL.Image\x94\x8c\x05Image\x94\x93\x94)\x81\x94]\x94(' \
           b'}\x94(\x8c\x04jfif\x94M\x02\x01\x8c\x0cjfif_version\x94K\x01K\x02\x86\x94\x8c\tjfif_unit\x94K\x00\x8c' \
           b'\x0cjfif_density\x94K\x01K\x01\x86\x94u\x8c\x01L\x94K\x0fK\x15\x86\x94NB;\x01\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff' \
           b'\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\xff' \
           b'\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00' \
           b'\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00' \
           b'\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff' \
           b'\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff' \
           b'\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00' \
           b'\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00' \
           b'\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff' \
           b'\x94eb.'

number_6 = b'\x80\x05\x95\xb1\x01\x00\x00\x00\x00\x00\x00\x8c\tPIL.Image\x94\x8c\x05Image\x94\x93\x94)\x81\x94]\x94(' \
           b'}\x94(\x8c\x04jfif\x94M\x02\x01\x8c\x0cjfif_version\x94K\x01K\x02\x86\x94\x8c\tjfif_unit\x94K\x00\x8c' \
           b'\x0cjfif_density\x94K\x01K\x01\x86\x94u\x8c\x01L\x94K\x0fK\x15\x86\x94NB;\x01\x00\x00\xff\xff\xff\xff' \
           b'\xff\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\xff\x00\x00\x00\x00\x00\xff' \
           b'\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00' \
           b'\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff' \
           b'\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\xff\x00' \
           b'\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00' \
           b'\x00\x00\xff\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\xff\x00\x00\x00\x00\x00\xff\xff\xff' \
           b'\xff\xff\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff' \
           b'\x94eb.'

number_5 = b'\x80\x05\x95\xb1\x01\x00\x00\x00\x00\x00\x00\x8c\tPIL.Image\x94\x8c\x05Image\x94\x93\x94)\x81\x94]\x94(' \
           b'}\x94(\x8c\x04jfif\x94M\x02\x01\x8c\x0cjfif_version\x94K\x01K\x02\x86\x94\x8c\tjfif_unit\x94K\x00\x8c' \
           b'\x0cjfif_density\x94K\x01K\x01\x86\x94u\x8c\x01L\x94K\x0fK\x15\x86\x94NB;\x01\x00\x00\xff\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff' \
           b'\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff' \
           b'\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff' \
           b'\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\xff\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\xff\x00\xff\xff\xff\xff' \
           b'\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00' \
           b'\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\x94eb.'

number_4 = b'\x80\x05\x95\xb1\x01\x00\x00\x00\x00\x00\x00\x8c\tPIL.Image\x94\x8c\x05Image\x94\x93\x94)\x81\x94]\x94(' \
           b'}\x94(\x8c\x04jfif\x94M\x02\x01\x8c\x0cjfif_version\x94K\x01K\x02\x86\x94\x8c\tjfif_unit\x94K\x00\x8c' \
           b'\x0cjfif_density\x94K\x01K\x01\x86\x94u\x8c\x01L\x94K\x0fK\x15\x86\x94NB;\x01\x00\x00\xff\xff\xff\xff' \
           b'\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff' \
           b'\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00' \
           b'\x00\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff' \
           b'\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00' \
           b'\xff\xff\x00\x00\x00\x00\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\xff\xff\xff\xff\xff\x00' \
           b'\x00\x00\x00\x00\xff\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\x00\x00\x00\xff\xff\xff' \
           b'\xff\xff\xff\x00\x00\x00\x00\x00\xff\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff' \
           b'\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff' \
           b'\x94eb.'

number_3 = b'\x80\x05\x95\xb1\x01\x00\x00\x00\x00\x00\x00\x8c\tPIL.Image\x94\x8c\x05Image\x94\x93\x94)\x81\x94]\x94(' \
           b'}\x94(\x8c\x04jfif\x94M\x02\x01\x8c\x0cjfif_version\x94K\x01K\x02\x86\x94\x8c\tjfif_unit\x94K\x00\x8c' \
           b'\x0cjfif_density\x94K\x01K\x01\x86\x94u\x8c\x01L\x94K\x0fK\x15\x86\x94NB;\x01\x00\x00\xff\xff\xff\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\xff\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff' \
           b'\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff' \
           b'\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00' \
           b'\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00' \
           b'\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\x94eb.'

number_2 = b'\x80\x05\x95\xb1\x01\x00\x00\x00\x00\x00\x00\x8c\tPIL.Image\x94\x8c\x05Image\x94\x93\x94)\x81\x94]\x94(' \
           b'}\x94(\x8c\x04jfif\x94M\x02\x01\x8c\x0cjfif_version\x94K\x01K\x02\x86\x94\x8c\tjfif_unit\x94K\x00\x8c' \
           b'\x0cjfif_density\x94K\x01K\x01\x86\x94u\x8c\x01L\x94K\x0fK\x15\x86\x94NB;\x01\x00\x00\xff\xff\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff' \
           b'\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\xff\xff\xff' \
           b'\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00' \
           b'\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00' \
           b'\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff' \
           b'\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff' \
           b'\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x94eb.'

number_1 = b'\x80\x05\x95\xb1\x01\x00\x00\x00\x00\x00\x00\x8c\tPIL.Image\x94\x8c\x05Image\x94\x93\x94)\x81\x94]\x94(' \
           b'}\x94(\x8c\x04jfif\x94M\x02\x01\x8c\x0cjfif_version\x94K\x01K\x02\x86\x94\x8c\tjfif_unit\x94K\x00\x8c' \
           b'\x0cjfif_density\x94K\x01K\x01\x86\x94u\x8c\x01L\x94K\x0fK\x15\x86\x94NB;\x01\x00\x00\xff\xff\xff\xff' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff' \
           b'\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\xff\xff\xff\xff\xff\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff' \
           b'\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff' \
           b'\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00' \
           b'\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff' \
           b'\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff' \
           b'\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff' \
           b'\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00' \
           b'\x00\x00\x00\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x94eb.'

number_0 = b'\x80\x05\x95\xb1\x01\x00\x00\x00\x00\x00\x00\x8c\tPIL.Image\x94\x8c\x05Image\x94\x93\x94)\x81\x94]\x94(' \
           b'}\x94(\x8c\x04jfif\x94M\x02\x01\x8c\x0cjfif_version\x94K\x01K\x02\x86\x94\x8c\tjfif_unit\x94K\x00\x8c' \
           b'\x0cjfif_density\x94K\x01K\x01\x86\x94u\x8c\x01L\x94K\x0fK\x15\x86\x94NB;\x01\x00\x00\xff\xff\xff\xff' \
           b'\xff\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00' \
           b'\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00' \
           b'\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff' \
           b'\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00' \
           b'\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff' \
           b'\xff\x00\x00\x00\x00\x00\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\x00\x00\x00' \
           b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff' \
           b'\x94eb.'

std_imgs = (
    pickle.loads(number_0),
    pickle.loads(number_1),
    pickle.loads(number_2),
    pickle.loads(number_3),
    pickle.loads(number_4),
    pickle.loads(number_5),
    pickle.loads(number_6),
    pickle.loads(number_7),
    pickle.loads(number_8),
    pickle.loads(number_9)
)

number_boxes = (
    (28, 4, 43, 25),
    (49, 4, 64, 25),
    (70, 4, 85, 25),
    (91, 4, 106, 25)
)

WIDTH, HEIGHT = 120, 32
WID, HEI = 15, 21


def _calculate_similarity(img1, img2) -> int:
    result = 0
    px1 = img1.load()
    px2 = img2.load()
    for y in range(HEI):
        for x in range(WID):
            if px1[x, y] == px2[x, y]:
                result += 1
    return result


def _get_single_number(img) -> str:
    similarities = []
    for idx in range(10):
        similarities.append(_calculate_similarity(std_imgs[idx], img))
    return str(similarities.index(max(similarities)))


def _get_validatecode(raw_img):
    img = Image.open(io.BytesIO(raw_img))
    img = img.convert("L")
    px = img.load()
    for y in range(HEIGHT):
        for x in range(WIDTH):
            if px[x, y] < 100:
                px[x, y] = 0
            else:
                px[x, y] = 255
    for y in range(HEIGHT):
        for x in range(WIDTH):
            if px[x, y] == 0:
                if x > 0:
                    if px[x - 1, y] == 0:
                        continue
                if x < WIDTH - 1:
                    if px[x + 1, y] == 0:
                        continue
                if y > 0:
                    if px[x, y - 1] == 0:
                        continue
                if y < HEIGHT - 1:
                    if px[x, y + 1] == 0:
                        continue
                px[x, y] = 255

    result = ""
    for idx in range(4):
        result += _get_single_number(img.crop(number_boxes[idx]))
    return result


def _get_form_list(text: str) -> dict:
    result = {}
    re_str = r"<input type=\"hidden\"[\s\S]*?name=\"(\S*?)\" value=\"(\S*?)\""
    for key, val in re.findall(re_str, text):
        result[key] = val
    return result


def _get_cas_lt(text: str) -> str:
    re_str = r"\$\(\"#CAS_LT\"\).val\(\"(\S*?)\"\);"
    match = re.search(re_str, text)
    return match.group(1)


async def cas_login(username: str, password: str, client: aiohttp.ClientSession, service="", autojump=False):
    """
    登录统一身份认证系统
    :param username: str 用户名
    :param password: str 密码
    :param service: str 使用统一身份认证系统的网址
    :param autojump: bool 登录成功后是否自动跳转
    :return: dict or None
    若登录成功，且autojump=False,返回tuple：location, ticket, cookies
    若登录成功，且autojump=True,返回 Response
    若登录失败，返回None
    """
    url = "https://passport.ustc.edu.cn/login"
    image_url = "https://passport.ustc.edu.cn/validatecode.jsp?type=login"
    
    rsps = await client.get(url, params={"service": service})
    form = _get_form_list(await rsps.text())
    cas_lt = _get_cas_lt(await rsps.text())
    
    form["username"] = username
    form["password"] = password
    form["CAS_LT"] = cas_lt
    if form["showCode"]:
        rsps = await client.get(image_url)
        form["LT"] = _get_validatecode(await rsps.read())
    form["button"] = ''
    
    rsps = await client.post(url, data=form, allow_redirects=autojump)
    if not autojump:
        if rsps.status != 302:
            return None
        re_obj = re.search(r"ticket=(\S*)", rsps.headers["location"])
        if re_obj:
            ticket = re_obj.group(1)
        else:
            ticket = None
        return rsps.headers["location"], ticket, rsps.cookies
    else:
        if re.search(r"中国科学技术大学统一身份认证系统[\S\s]*?请输入验证码！", await rsps.text()):
            return None
        return rsps


__all__ = ["cas_login"]


if __name__ == "__main__":
    help(cas_login)
